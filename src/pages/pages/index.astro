---
import Layout from "../layouts/Layout.astro";
---

<Layout title="Astro Mini Game">
  <div
    class="flex items-center justify-center min-h-screen bg-gradient-to-b from-slate-900 to-slate-800 px-4"
  >
    <div
      class="w-full max-w-3xl bg-white/5 backdrop-blur-md rounded-2xl shadow-xl p-8 border border-white/10 text-center"
    >
      <h1 class="text-3xl font-bold text-white mb-3">üöÄ Click the Asteroid!</h1>
      <p class="text-lg text-slate-300 mb-6">
        Score points by clicking the moving asteroid before it disappears.
      </p>

      <canvas
        id="gameCanvas"
        width="700"
        height="500"
        class="rounded-lg shadow-lg border border-slate-600 bg-slate-900/70"
      ></canvas>

      <p class="mt-6 text-xl text-slate-200">
        Score: <span id="score" class="font-bold text-indigo-400">0</span>
      </p>

      <div class="mt-8">
        <a
          href="/"
          class="px-6 py-3 text-lg font-medium rounded-xl bg-indigo-500 hover:bg-indigo-600 active:scale-95 shadow-md shadow-indigo-500/30 text-white transition-all"
        >
          ‚Üê Back to Home
        </a>
      </div>

      <footer
        class="mt-10 text-center text-slate-500 text-sm border-t border-slate-700 pt-4"
      >
        <p>
          Created by <a
            href="https://github.com/mhaques"
            target="_blank"
            class="text-indigo-400 hover:underline">mhaques</a>
        </p>
        <p class="mt-1">
          Source code available on <a
            href="https://github.com/mhaques/astrolab"
            target="_blank"
            class="text-indigo-400 hover:underline">GitHub</a>
        </p>
      </footer>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let asteroid = { x: 100, y: 100, size: 40 };
    let score = 0;

    function drawAsteroid() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      ctx.arc(asteroid.x, asteroid.y, asteroid.size, 0, Math.PI * 2);
      ctx.fillStyle = "#ff9933";
      ctx.fill();
      ctx.strokeStyle = "#fff";
      ctx.stroke();
    }

    function moveAsteroid() {
      asteroid.x =
        Math.random() * (canvas.width - asteroid.size * 2) + asteroid.size;
      asteroid.y =
        Math.random() * (canvas.height - asteroid.size * 2) + asteroid.size;
      drawAsteroid();
    }

    canvas.addEventListener("click", (e) => {
      const rect = canvas.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const clickY = e.clientY - rect.top;

      const dist = Math.sqrt(
        (clickX - asteroid.x) ** 2 + (clickY - asteroid.y) ** 2
      );

      if (dist < asteroid.size) {
        score++;
        document.getElementById("score").textContent = score;
        moveAsteroid();
      }
    });

    drawAsteroid();
    setInterval(moveAsteroid, 2000);
  </script>
</Layout>
